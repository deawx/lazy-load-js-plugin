
/*! JSLazyLoading JavaScript plugin - Version 1.0.7
-------------------------------------------------------------------------
	Copyright (C) 2015 Addon Dev. All rights reserved.
	Website: www.addondev.com
	GitHub: github.com/addondev
	Developer: Philip Sorokin
	Location: Russia, Moscow
	E-mail: philip.sorokin@gmail.com
	Created: June 2015
	License: GNU GPLv2 http://www.gnu.org/licenses/gpl-2.0.html
------------------------------------------------------------------------------ */

function JSLazyLoading(a){"use strict";function s(a){for(var c=0,d=g.getElementsByTagName("img"),e=d.length;e>c;c++)d[c].getAttribute(b.dataAttribute)&&a(d[c])}function t(a,b){try{for(var c=0,d=a.length;d>c;c++)if(a[c]&&b(a[c],c))return!0}catch(e){}}function u(a,b){for(var c=0,d=a.length;d>c;c++)a[c]&&b(a[c],c)}function F(a,c,d){var e=d||a;e.onerror=function(){"undefined"!=typeof a.jsllCSSText&&(a.style.cssText=a.jsllCSSText),d&&(a.setAttribute("data-error-src",d.src),a.src="about:blank"),setTimeout(M,100)},e.src=c,a.removeAttribute(b.dataAttribute),m--}function J(){var a=n,c=o;return n=b.container===d?f.innerWidth||i.clientWidth||e.body.clientWidth:f.clientWidth,o=b.container===d?f.innerHeight||i.clientHeight||e.body.clientHeight:f.clientHeight,a!==n||c!==o}function K(){J()?(b.softMode&&u(h,function(a){a.jsllProportion&&(a.style.height=a.offsetWidth/a.jsllProportion+"px")}),L()):M()}function L(){try{h.sort(function(a,b){var c=A(a),d=A(b);return c.top===d.top?c.left-d.left:c.top-d.top}),M()}catch(a){}}function M(a,c){var d,e=0;if(y)var f=y();c=c||!b.rectangularScope,t(h,function(a,g){if(z(a,f))E(d=a),delete h[g];else if(e++>=b.limit)return d?(v(d,"load",function(){M(null,!0)}),!0):c})}function N(){clearTimeout(j),t(h,function(a,c){return E(a),v(a,"load",function(){j=setTimeout(N,b.sequentialLoading)}),delete h[c]})}function O(){k=setInterval(function(){var a=0;s(function(){a++}),a!==m&&l.refresh()},100)}var b={docReady:!0,container:window,dataAttribute:"data-src",multiServe:!1,multiServeBreakpoints:{"data-src-extra-small":220,"data-src-small":420,"data-src-medium":768},sequentialLoading:null,placeholder:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",loaderImage:null,backgroundColor:null,fadeInEffect:!0,fadeInDuration:400,fadeInPreserveOpacity:!0,softMode:!1,ajaxListener:!1,limit:0,rectangularScope:!1,rangeY:0,rangeX:0};if("object"==typeof a)for(var c in a)b[c]=a[c];var f,g,h,j,k,m,n,o,d=window,e=d.document,i=e.documentElement,l=this,p="width",q="height",r="";if(/MSIE ([\d.]+)/.test(navigator.userAgent)&&RegExp.$1<9){var v=function(a,b,c){a.attachEvent("on"+b,c)},w=function(a,b,c){a.detachEvent("on"+b,c)},x=function(a){try{i.doScroll("left"),a()}catch(b){setTimeout(function(){x(a)},10)}};RegExp.$1<8&&(p="data-width",q="data-height")}else v=function(a,b,c){a.addEventListener(b,c,!1)},w=function(a,b,c){a.removeEventListener(b,c,!1)},x=function(a){"complete"===e.readyState?a():e.addEventListener("DOMContentLoaded",a,!1)};if(b.container!==d||!i.getBoundingClientRect||/iP(hone|od|ad).+? OS (\d+)/.test(navigator.platform)&&RegExp.$1<5)var y=function(){if(b.container===d)var a=d.pageYOffset||i.scrollTop,c=d.pageXOffset||i.scrollLeft;else a=f.scrollTop,c=f.scrollLeft;return{top:a,left:c}},z=b.rectangularScope?function(a,c){var d=0,e=0,g=a.offsetWidth,h=a.offsetHeight;do d+=a.offsetTop||0,e+=a.offsetLeft||0,a=a.offsetParent;while(a&&a!=f);return d<=o+c.top+b.rangeY&&d+h>=c.top-b.rangeY&&e<=n+c.left+b.rangeX&&e+g>=c.left-b.rangeX}:function(a,b){var c=0;do c+=a.offsetTop||0,a=a.offsetParent;while(a&&a!=f);return c<=o+b.top},A=function(a){var b=0,c=0;do b+=a.offsetTop||0,c+=a.offsetLeft||0,a=a.offsetParent;while(a&&a!=f);return{top:b,left:c}};else z=b.rectangularScope?function(a){var c=a.getBoundingClientRect();return c.top<=o+b.rangeY&&c.bottom>=0-b.rangeY&&c.left<=n+b.rangeX&&c.right>=0-b.rangeX}:function(a){return a.getBoundingClientRect().top<=o+b.rangeY},A=function(a){return a.getBoundingClientRect()};var B=function(a){return a.getAttribute(b.dataAttribute)};if(b.multiServe&&"object"==typeof b.multiServeBreakpoints){var C=new Array;for(var D in b.multiServeBreakpoints)d.screen.width<=b.multiServeBreakpoints[D]&&C.push({name:D,value:b.multiServeBreakpoints[D]});if(C.length){C.sort(function(a,b){return a.value>b.value});for(var c=0;c<C.length;c++)C[c]=C[c].name;B=function(a){for(var d,c=0;c<C.length;c++)if(d=a.getAttribute(C[c]))return d;return a.getAttribute(b.dataAttribute)}}}var E=function(a){var b=B(a);b&&("undefined"!=typeof a.jsllCSSText&&v(a,"load",function(){a.style.cssText=a.jsllCSSText}),F(a,b))};if(b.fadeInEffect){var G=function(){for(var a=0;a<arguments.length;a++)if(arguments[a]in i.style)return arguments[a]}("transition","-webkit-transition","-moz-transition","-o-transition");if(G&&("desktop"!==b.fadeInEffect||!("ontouchstart"in d||"onmsgesturechange"in d)||d.screen.width>768)){if(/Chrome/.test(navigator.userAgent)){var H=e.createElement("style");H.type="text/css",H.appendChild(e.createTextNode("img {-webkit-transform: translateZ(0px)}")),e.getElementsByTagName("head")[0].appendChild(H)}E=function(a){var c=B(a);if(c){var d=new Image;v(d,"load",function(){if(a.style.cssText=a.jsllCSSText||"",b.fadeInPreserveOpacity)var c=getComputedStyle(a,"").opacity,e=1*b.fadeInDuration/c;else c=1,e=b.fadeInDuration;a.style.cssText+="; opacity: 0 !important; ",a.src=d.src,setTimeout(function(){a.style.cssText+=G+": opacity "+e+"ms ease-in !important; opacity: "+c+" !important; ",setTimeout(function(){a.style.cssText=a.jsllCSSText||""},e+200)},16)}),F(a,c,d)}}}}if(b.backgroundColor&&(r+="; background-color: "+b.backgroundColor+" !important"),b.loaderImage&&(r+="; background-image: url('"+b.loaderImage+"') !important; background-position: center center !important; background-repeat: no-repeat !important"),b.softMode)var I=function(a){var b=a.getAttribute(p),c=a.getAttribute(q);if(b&&c){a.jsllProportion=b/c;var c=a.offsetWidth/a.jsllProportion}a.jsllCSSText=a.getAttribute("style")||"",a.style.cssText+=r+"; height: "+c+"px"};else r&&(I=function(a){a.jsllCSSText=a.getAttribute("style")||"",a.style.cssText+=r});this.refresh=function(){l.started&&(J(),h=new Array,s(function(a){h.push(a),a.src=b.placeholder,I&&"undefined"==typeof a.jsllCSSText&&I(a)}),m=h.length,"number"==typeof b.sequentialLoading&&N(),"complete"!==e.readyState?(v(d,"load",L),M()):L())},this.abort=function(){l.started=!1,w(f,"scroll",M),w(f,"resize",K),k&&(clearInterval(k),JSLazyLoading.ajaxListenerEnabled=!1),s(function(a){var b=B(a);b&&(a.src=b)})},this.start=function(){l.started||(b.container===d?(f=d,g=e):(f=e.getElementById(b.container),g=f),d.operamini?l.abort():f&&(l.started=!0,l.refresh(),v(f,"scroll",M),v(f,"resize",K),b.ajaxListener&&!JSLazyLoading.ajaxListenerEnabled&&(JSLazyLoading.ajaxListenerEnabled=!0,O())))},b.docReady?x(this.start):this.start()}